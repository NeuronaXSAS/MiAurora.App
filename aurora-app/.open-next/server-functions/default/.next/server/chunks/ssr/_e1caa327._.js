module.exports=[210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},92759,a=>{"use strict";let b=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>b],92759)},49289,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(11241);var d=a.i(96373),e=a.i(1322),f=a.i(40695),g=a.i(46893),h=a.i(7706),i=a.i(210),j=a.i(92759),k=a.i(50944),l=a.i(94632);function m(){let a=(0,k.useParams)().userId,[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),s=(0,c.useRef)(null),t=(0,k.useRouter)();(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/auth/me"),b=await a.json();b.userId&&n(b.userId)}catch(a){console.error("Error getting user:",a)}})()},[]);let u=(0,d.useQuery)(e.api.directMessages.getConversation,m?{userId:m,otherUserId:a}:"skip"),v=(0,d.useQuery)(e.api.users.getUser,a?{userId:a}:"skip"),w=(0,d.useMutation)(e.api.directMessages.send),x=(0,d.useMutation)(e.api.directMessages.markAsRead);(0,c.useEffect)(()=>{m&&a&&x({userId:m,otherUserId:a})},[m,a,u]),(0,c.useEffect)(()=>{s.current?.scrollIntoView({behavior:"smooth"})},[u]);let y=async()=>{if(m&&o.trim()){r(!0);try{await w({senderId:m,receiverId:a,content:o.trim()}),p("")}catch(a){console.error("Send error:",a),alert("Failed to send message")}finally{r(!1)}}};return(0,b.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-white border-b flex-shrink-0",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",onClick:()=>t.push("/messages"),children:(0,b.jsx)(i.ArrowLeft,{className:"w-5 h-5"})}),(0,b.jsxs)(h.Avatar,{children:[(0,b.jsx)(h.AvatarImage,{src:v?.profileImage}),(0,b.jsx)(h.AvatarFallback,{children:v?.name?.charAt(0).toUpperCase()||"U"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold",children:v?.name||"Loading..."}),(0,b.jsxs)("p",{className:"text-xs text-gray-500",children:["Trust Score: ",v?.trustScore||0]})]})]})})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto px-4 py-6",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-4",children:[!u&&(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"w-12 h-12 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading messages..."})]}),u&&0===u.length&&(0,b.jsx)("div",{className:"text-center py-12",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No messages yet. Start the conversation!"})}),u&&u.map(a=>{let c=a.senderId===m;return(0,b.jsx)("div",{className:`flex ${c?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-[70%] ${c?"bg-purple-600 text-white":"bg-white text-gray-900"} rounded-2xl px-4 py-2 shadow-sm`,children:[!c&&(0,b.jsx)("p",{className:"text-xs font-semibold mb-1",children:a.sender?.name}),(0,b.jsx)("p",{className:"whitespace-pre-wrap break-words",children:a.content}),(0,b.jsx)("p",{className:`text-xs mt-1 ${c?"text-purple-200":"text-gray-500"}`,children:(0,l.formatDistanceToNow)(a._creationTime,{addSuffix:!0})})]})},a._id)}),(0,b.jsx)("div",{ref:s})]})}),(0,b.jsx)("div",{className:"bg-white border-t flex-shrink-0",children:(0,b.jsx)("div",{className:"container mx-auto px-4 py-3",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto flex gap-2",children:[(0,b.jsx)(g.Textarea,{placeholder:"Type a message...",value:o,onChange:a=>p(a.target.value),onKeyPress:a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),y())},className:"min-h-[60px] max-h-[120px] resize-none",disabled:q}),(0,b.jsx)(f.Button,{onClick:y,disabled:!o.trim()||q,className:"bg-purple-600 hover:bg-purple-700 h-[60px] px-6",children:(0,b.jsx)(j.Send,{className:"w-5 h-5"})})]})})})]})}a.s(["default",()=>m])}];

//# sourceMappingURL=_e1caa327._.js.map