module.exports=[24669,a=>{"use strict";let b=(0,a.i(70106).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);a.s(["TrendingUp",()=>b],24669)},53940,a=>{"use strict";let b="offline-routes";function c(a,b,c,d){let e=a*Math.PI/180,f=c*Math.PI/180,g=(c-a)*Math.PI/180,h=(d-b)*Math.PI/180,i=Math.sin(g/2)*Math.sin(g/2)+Math.cos(e)*Math.cos(f)*Math.sin(h/2)*Math.sin(h/2);return 2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i))*6371e3}async function d(a,c){let d=await new Promise((a,c)=>{let d=indexedDB.open("aurora-routes",1);d.onerror=()=>c(d.error),d.onsuccess=()=>a(d.result),d.onupgradeneeded=a=>{let c=a.target.result;c.objectStoreNames.contains(b)||c.createObjectStore(b,{keyPath:"id",autoIncrement:!0})}}),e=d.transaction([b],"readwrite").objectStore(b);await new Promise((b,d)=>{let f=e.put({routeId:a,coordinates:c,timestamp:Date.now()});f.onsuccess=()=>b(),f.onerror=()=>d(f.error)}),d.close()}class e{watchId=null;state={isTracking:!1,isPaused:!1,coordinates:[],stats:{distance:0,duration:0,pace:0,elevationGain:0},startTime:null,pausedTime:0};lastSampleTime=0;lastSamplePosition=null;onUpdate=null;onError=null;start(a,b){this.state.isTracking||(this.onUpdate=a,this.onError=b||null,this.state.isTracking=!0,this.state.isPaused=!1,this.state.startTime=Date.now(),this.lastSampleTime=Date.now(),"geolocation"in navigator?this.watchId=navigator.geolocation.watchPosition(a=>this.handlePosition(a),a=>this.handleError(a),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):this.handleError({code:0,message:"Geolocation not supported"}))}pause(){this.state.isTracking&&!this.state.isPaused&&(this.state.isPaused=!0,this.notifyUpdate())}resume(){this.state.isTracking&&this.state.isPaused&&(this.state.isPaused=!1,this.state.pausedTime+=Date.now()-(this.lastSampleTime||Date.now()),this.lastSampleTime=Date.now(),this.notifyUpdate())}stop(){return null!==this.watchId&&(navigator.geolocation.clearWatch(this.watchId),this.watchId=null),this.state.isTracking=!1,this.state.isPaused=!1,this.state.startTime&&(this.state.stats.duration=Math.floor((Date.now()-this.state.startTime-this.state.pausedTime)/1e3)),{...this.state}}getState(){return{...this.state}}handlePosition(a){if(!this.state.isTracking||this.state.isPaused)return;let b={lat:a.coords.latitude,lng:a.coords.longitude,timestamp:a.timestamp,elevation:a.coords.altitude||void 0};this.shouldSample(b)&&(this.state.coordinates.push(b),this.lastSamplePosition=b,this.lastSampleTime=Date.now(),this.updateStats(),this.notifyUpdate(),this.state.coordinates.length%10==0&&this.saveToOfflineStorage())}shouldSample(a){return!!(!this.lastSamplePosition||Date.now()-this.lastSampleTime>=5e3||c(this.lastSamplePosition.lat,this.lastSamplePosition.lng,a.lat,a.lng)>=10)}updateStats(){this.state.stats.distance=function(a){if(a.length<2)return 0;let b=0;for(let d=1;d<a.length;d++)b+=c(a[d-1].lat,a[d-1].lng,a[d].lat,a[d].lng);return b}(this.state.coordinates),this.state.stats.elevationGain=function(a){if(a.length<2)return 0;let b=0;for(let c=1;c<a.length;c++){let d=a[c-1].elevation||0,e=a[c].elevation||0;e>d&&(b+=e-d)}return b}(this.state.coordinates),this.state.startTime&&(this.state.stats.duration=Math.floor((Date.now()-this.state.startTime-this.state.pausedTime)/1e3)),this.state.stats.distance>0&&this.state.stats.duration>0&&(this.state.stats.pace=this.state.stats.duration/60/(this.state.stats.distance/1e3))}handleError(a){console.error("GPS Error:",a),this.onError&&this.onError(a)}notifyUpdate(){this.onUpdate&&this.onUpdate({...this.state})}async saveToOfflineStorage(){try{await d("current",this.state.coordinates)}catch(a){console.error("Failed to save offline route:",a)}}}function f(a){let b=Math.floor(a/3600),c=Math.floor(a%3600/60),d=a%60;return b>0?`${b}:${c.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`:`${c}:${d.toString().padStart(2,"0")}`}function g(a){return a>=1e3?`${(a/1e3).toFixed(2)} km`:`${Math.round(a)} m`}function h(a){if(!isFinite(a)||0===a)return"--:--";let b=Math.floor(a),c=Math.round((a-b)*60);return`${b}:${c.toString().padStart(2,"0")}`}a.s(["GPSTracker",()=>e,"formatDistance",()=>g,"formatDuration",()=>f,"formatPace",()=>h])},210,a=>{"use strict";let b=(0,a.i(70106).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);a.s(["ArrowLeft",()=>b],210)},60246,a=>{"use strict";let b=(0,a.i(70106).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],60246)},87532,a=>{"use strict";let b=(0,a.i(70106).default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);a.s(["Search",()=>b],87532)},69012,a=>{"use strict";let b=(0,a.i(70106).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);a.s(["Filter",()=>b],69012)},53495,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(11241);var d=a.i(96373),e=a.i(1322),f=a.i(40695),g=a.i(3130),h=a.i(5522),i=a.i(87532),j=a.i(69012),k=a.i(24987),l=a.i(21374),m=a.i(24669),n=a.i(60246),o=a.i(210),p=a.i(50944),q=a.i(53940);function r(){let[a,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)("all"),[w,x]=(0,c.useState)(0),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)("grid"),C=(0,p.useRouter)();(0,c.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/auth/me"),b=await a.json();b.userId&&r(b.userId)}catch(a){console.error("Error getting user:",a)}})()},[]);let D=(0,d.useQuery)(e.api.routes.getPublicRoutes,{limit:50,routeType:"all"!==u?u:void 0,minRating:w>0?w:void 0}),E=D?.filter(a=>{if(s){let b=s.toLowerCase(),c=a.title.toLowerCase().includes(b),d=a.tags.some(a=>a.toLowerCase().includes(b)),e=a.startLocation.name.toLowerCase().includes(b)||a.endLocation.name.toLowerCase().includes(b);if(!c&&!d&&!e)return!1}return(!(y.length>0)||!!y.every(b=>a.tags.includes(b)))&&!0})||[],F=Array.from(new Set(D?.flatMap(a=>a.tags)||[]));return(0,b.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,b.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 py-6 sm:py-8",children:[(0,b.jsx)("div",{className:"flex items-center gap-3 mb-4",children:(0,b.jsxs)(f.Button,{variant:"ghost",size:"sm",onClick:()=>C.push("/routes"),className:"text-white hover:bg-white/20",children:[(0,b.jsx)(o.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]})}),(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold mb-2",children:"Discover Routes"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-blue-100",children:"Find safe and inspiring routes shared by the community"})]})}),(0,b.jsx)("div",{className:"container mx-auto px-4 sm:px-6 py-6 sm:py-8",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[(0,b.jsx)("div",{className:"lg:col-span-1",children:(0,b.jsx)(g.Card,{className:"sticky top-24",children:(0,b.jsxs)(g.CardContent,{className:"p-4 space-y-4",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[(0,b.jsx)(j.Filter,{className:"w-4 h-4"}),"Filters"]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Search"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(i.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,b.jsx)(h.Input,{placeholder:"Search routes...",value:s,onChange:a=>t(a.target.value),className:"pl-9"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Activity Type"}),(0,b.jsx)("div",{className:"space-y-2",children:["all","walking","running","cycling","commuting"].map(a=>(0,b.jsx)("button",{onClick:()=>v(a),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors capitalize ${u===a?"bg-purple-100 text-purple-700 font-medium":"hover:bg-gray-100"}`,children:a},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Minimum Rating"}),(0,b.jsx)("div",{className:"space-y-2",children:[0,3,4,5].map(a=>(0,b.jsx)("button",{onClick:()=>x(a),className:`w-full text-left px-3 py-2 rounded-lg text-sm transition-colors ${w===a?"bg-purple-100 text-purple-700 font-medium":"hover:bg-gray-100"}`,children:0===a?"Any":`${a}+ stars`},a))})]}),F.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Tags"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:F.map(a=>(0,b.jsx)("button",{onClick:()=>{z(b=>b.includes(a)?b.filter(b=>b!==a):[...b,a])},className:`px-3 py-1 rounded-full text-xs font-medium transition-colors ${y.includes(a)?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:a},a))})]}),("all"!==u||w>0||y.length>0||s)&&(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{v("all"),x(0),z([]),t("")},className:"w-full",children:"Clear All Filters"})]})})}),(0,b.jsxs)("div",{className:"lg:col-span-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsxs)("p",{className:"text-sm text-gray-600",children:[E.length," ",1===E.length?"route":"routes"," found"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{variant:"grid"===A?"default":"outline",size:"sm",onClick:()=>B("grid"),children:"Grid"}),(0,b.jsx)(f.Button,{variant:"list"===A?"default":"outline",size:"sm",onClick:()=>B("list"),children:"List"})]})]}),!D&&(0,b.jsxs)("div",{className:"text-center py-12",children:[(0,b.jsx)("div",{className:"w-16 h-16 border-4 border-purple-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Loading routes..."})]}),0===E.length&&D&&(0,b.jsx)(g.Card,{children:(0,b.jsxs)(g.CardContent,{className:"py-12 text-center",children:[(0,b.jsx)(i.Search,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No routes found"}),(0,b.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your filters or search query"})]})}),E.length>0&&(0,b.jsx)("div",{className:"grid"===A?"grid grid-cols-1 md:grid-cols-2 gap-4":"space-y-4",children:E.map(a=>(0,b.jsx)(g.Card,{className:"hover-lift cursor-pointer",onClick:()=>C.push(`/routes/discover/${a._id}`),children:(0,b.jsxs)(g.CardContent,{className:"p-4",children:[(0,b.jsx)("div",{className:"w-full h-32 bg-gradient-to-br from-purple-100 to-blue-100 rounded-lg mb-3 flex items-center justify-center",children:(0,b.jsx)(k.MapPin,{className:"w-8 h-8 text-purple-600"})}),(0,b.jsx)("h3",{className:"font-semibold text-lg mb-2",children:a.title}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1 mb-3",children:[a.tags.slice(0,3).map((a,c)=>(0,b.jsx)("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded-full",children:a},c)),a.tags.length>3&&(0,b.jsxs)("span",{className:"px-2 py-0.5 bg-gray-100 text-gray-600 text-xs rounded-full",children:["+",a.tags.length-3]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(m.TrendingUp,{className:"w-4 h-4 text-gray-500"}),(0,b.jsx)("span",{className:"font-medium",children:(0,q.formatDistance)(a.distance)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(l.Star,{className:"w-4 h-4 text-yellow-500"}),(0,b.jsxs)("span",{className:"font-medium",children:[a.rating,"/5"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600 pt-3 border-t",children:[(0,b.jsxs)("span",{children:["by ",a.creator.name]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(n.Users,{className:"w-3 h-3"}),(0,b.jsxs)("span",{children:[a.completionCount||0," completed"]})]})]})]})},a._id))})]})]})})})]})}a.s(["default",()=>r])}];

//# sourceMappingURL=_065aea70._.js.map