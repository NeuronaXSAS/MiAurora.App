(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,14764,e=>{"use strict";let t=(0,e.i(75254).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],14764)},90597,e=>{"use strict";let t=(0,e.i(75254).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);e.s(["Heart",()=>t],90597)},30699,43553,e=>{"use strict";var t=e.i(75254);let s=(0,t.default)("gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);e.s(["Gift",()=>s],30699);let a=(0,t.default)("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);e.s(["Crown",()=>a],43553)},81946,e=>{"use strict";var t=e.i(43476),s=e.i(932),a=e.i(71645),i=e.i(84073);e.i(50711);var r=e.i(82045),l=e.i(83394),n=e.i(67881),c=e.i(23750),o=e.i(63270),d=e.i(90597),m=e.i(30699),h=e.i(61911),x=e.i(37727),u=e.i(14764),p=e.i(47163),f=e.i(30374),b=e.i(94179),j=e.i(75822),g=e.i(83086),v=e.i(43553),w=e.i(98919),y=e.i(70273);let N=[{id:"rose",name:"Rose",icon:(0,t.jsx)(d.Heart,{className:"w-8 h-8"}),cost:5,color:"from-pink-500 to-red-500",description:"Show appreciation"},{id:"star",name:"Star",icon:(0,t.jsx)(y.Star,{className:"w-8 h-8"}),cost:10,color:"from-yellow-400 to-orange-500",description:"You're a star!"},{id:"shield",name:"Safety Shield",icon:(0,t.jsx)(w.Shield,{className:"w-8 h-8"}),cost:25,color:"from-blue-500 to-cyan-500",description:"Support safety"},{id:"sparkle",name:"Sparkle",icon:(0,t.jsx)(g.Sparkles,{className:"w-8 h-8"}),cost:50,color:"from-purple-500 to-pink-500",description:"Amazing content!"},{id:"crown",name:"Crown",icon:(0,t.jsx)(v.Crown,{className:"w-8 h-8"}),cost:100,color:"from-yellow-600 to-amber-600",description:"You're royalty!"}];function k({open:e,onClose:s,senderId:i,recipientId:c,livestreamId:o}){let[d,m]=(0,a.useState)(null),[h,x]=(0,a.useState)(!1),u=(0,r.useQuery)(l.api.users.getUser,{userId:i}),g=async e=>{if(u){if(u.credits<e.cost)return void alert(`Insufficient credits. You need ${e.cost} credits but only have ${u.credits}.`);if(confirm(`Send ${e.name} for ${e.cost} credits?`)){x(!0);try{await fetch("/api/credits/transfer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({senderId:i,recipientId:c,amount:e.cost,type:"gift",giftId:e.id,livestreamId:o})}),alert(`${e.name} sent successfully!`),s()}catch(e){console.error("Failed to send gift:",e),alert("Failed to send gift. Please try again.")}finally{x(!1)}}}};return(0,t.jsx)(f.Dialog,{open:e,onOpenChange:e=>!e&&s(),children:(0,t.jsxs)(f.DialogContent,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(f.DialogHeader,{children:[(0,t.jsx)(f.DialogTitle,{children:"Send a Gift"}),(0,t.jsx)(f.DialogDescription,{children:"Support the streamer with virtual gifts"})]}),u&&(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-purple-50 rounded-lg mb-4",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Your Credits"}),(0,t.jsxs)(b.Badge,{className:"bg-purple-600 text-lg px-3 py-1",children:[(0,t.jsx)(j.Coins,{className:"w-4 h-4 mr-1"}),u.credits]})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-4",children:N.map(e=>(0,t.jsxs)("button",{onClick:()=>m(e),disabled:h||!!u&&u.credits<e.cost,className:(0,p.cn)("relative p-6 rounded-xl border-2 transition-all","hover:scale-105 active:scale-95","disabled:opacity-50 disabled:cursor-not-allowed",d?.id===e.id?"border-purple-600 bg-purple-50":"border-gray-200 hover:border-purple-300"),children:[(0,t.jsx)("div",{className:(0,p.cn)("w-16 h-16 rounded-full mx-auto mb-3 flex items-center justify-center","bg-gradient-to-br text-white",e.color),children:e.icon}),(0,t.jsx)("p",{className:"font-semibold text-center mb-1",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-gray-600 text-center mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center justify-center gap-1 text-purple-600 font-bold",children:[(0,t.jsx)(j.Coins,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:e.cost})]}),u&&u.credits<e.cost&&(0,t.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-xl flex items-center justify-center",children:(0,t.jsx)("span",{className:"text-white text-xs font-medium",children:"Insufficient Credits"})})]},e.id))}),d&&(0,t.jsx)(n.Button,{onClick:()=>g(d),disabled:h||!!u&&u.credits<d.cost,className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",size:"lg",children:h?"Sending...":(0,t.jsxs)(t.Fragment,{children:["Send ",d.name," for ",d.cost," Credits"]})}),(0,t.jsx)("p",{className:"text-xs text-center text-gray-500",children:"Credits will be transferred to the streamer's account"})]})})}function S(e){let f,b,j,g,v,w,y,N,S,C,I,_,L,z,B,M,A,T,D,F,H,U,$,G,O,P,Y,E,K,R,Q,J,V,X=(0,s.c)(94),{livestreamId:q,userId:W,onClose:Z}=e,[ee,et]=(0,a.useState)(""),[es,ea]=(0,a.useState)(!1),[ei,er]=(0,a.useState)(!1),[el,en]=(0,a.useState)(!1);X[0]!==q?(f={livestreamId:q},X[0]=q,X[1]=f):f=X[1];let ec=(0,r.useQuery)(l.api.livestreams.getLivestream,f),eo=(0,r.useMutation)(l.api.livestreams.joinLivestream),ed=(0,r.useMutation)(l.api.livestreams.leaveLivestream),em=(0,r.useMutation)(l.api.livestreams.likeLivestream),{isConnected:eh,error:ex,initialize:eu,joinAsViewer:ep,leave:ef}=(0,i.useLivestream)();X[2]!==eu||X[3]!==eh||X[4]!==ep||X[5]!==eo||X[6]!==ef||X[7]!==ed||X[8]!==ec||X[9]!==q||X[10]!==W?(b=()=>(ec&&!eh&&(async()=>{try{await eo({livestreamId:q,userId:W}),await eu({channelName:ec.channelName,userId:W,role:"audience"}),await ep()}catch(e){console.error("Failed to join livestream:",e)}})(),()=>{eh&&(ef(),ed({livestreamId:q,userId:W}))}),X[2]=eu,X[3]=eh,X[4]=ep,X[5]=eo,X[6]=ef,X[7]=ed,X[8]=ec,X[9]=q,X[10]=W,X[11]=b):b=X[11],X[12]!==eh||X[13]!==ec||X[14]!==q||X[15]!==W?(j=[ec,q,W,eh],X[12]=eh,X[13]=ec,X[14]=q,X[15]=W,X[16]=j):j=X[16],(0,a.useEffect)(b,j),X[17]!==ei||X[18]!==em||X[19]!==q||X[20]!==W?(g=async()=>{try{await em({livestreamId:q,userId:W}),er(!ei),en(!0),setTimeout(()=>en(!1),1e3)}catch(e){console.error("Failed to like livestream:",e)}},X[17]=ei,X[18]=em,X[19]=q,X[20]=W,X[21]=g):g=X[21];let eb=g;X[22]!==ee?(v=()=>{ee.trim()&&(console.log("Send comment:",ee),et(""))},X[22]=ee,X[23]=v):v=X[23];let ej=v;if(!ec){let e;return X[24]===Symbol.for("react.memo_cache_sentinel")?(e=(0,t.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,t.jsx)("div",{className:"text-white",children:"Loading..."})}),X[24]=e):e=X[24],e}let eg=`remote-video-${ec.hostId}`;X[25]!==eg?(w=(0,t.jsx)("div",{id:eg,className:"w-full h-full bg-gray-900"}),X[25]=eg,X[26]=w):w=X[26],X[27]!==eh?(y=!eh&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:(0,t.jsxs)("div",{className:"text-center text-white",children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-white border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{children:"Connecting to stream..."})]})}),X[27]=eh,X[28]=y):y=X[28],X[29]!==ex||X[30]!==Z?(N=ex&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:(0,t.jsxs)("div",{className:"text-center text-white p-6",children:[(0,t.jsx)("p",{className:"text-red-500 mb-4",children:ex}),(0,t.jsx)(n.Button,{onClick:Z,variant:"outline",children:"Go Back"})]})}),X[29]=ex,X[30]=Z,X[31]=N):N=X[31],X[32]!==ec.host||X[33]!==ec.viewerCount?(S=ec.host&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.Avatar,{className:"w-10 h-10 border-2 border-white",children:[(0,t.jsx)(o.AvatarImage,{src:ec.host.profileImage}),(0,t.jsx)(o.AvatarFallback,{children:ec.host.name[0].toUpperCase()})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-white font-semibold text-sm",children:ec.host.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"bg-red-600 px-2 py-0.5 rounded text-white text-xs font-bold",children:"LIVE"}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-white text-xs",children:[(0,t.jsx)(h.Users,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:ec.viewerCount})]})]})]})]}),X[32]=ec.host,X[33]=ec.viewerCount,X[34]=S):S=X[34],X[35]!==S?(C=(0,t.jsx)("div",{className:"flex items-center gap-3",children:S}),X[35]=S,X[36]=C):C=X[36],X[37]===Symbol.for("react.memo_cache_sentinel")?(I=(0,t.jsx)(x.X,{className:"w-6 h-6"}),X[37]=I):I=X[37],X[38]!==Z?(_=(0,t.jsx)(n.Button,{onClick:Z,variant:"ghost",size:"icon",className:"text-white hover:bg-white/20",children:I}),X[38]=Z,X[39]=_):_=X[39],X[40]!==C||X[41]!==_?(L=(0,t.jsx)("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/70 to-transparent z-10",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[C,_]})}),X[40]=C,X[41]=_,X[42]=L):L=X[42],X[43]!==el?(z=el&&(0,t.jsx)("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-20",children:(0,t.jsx)(d.Heart,{className:"w-32 h-32 text-red-500 fill-red-500 animate-ping"})}),X[43]=el,X[44]=z):z=X[44],X[45]!==ec.title?(B=(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("p",{className:"text-white font-medium",children:ec.title})}),X[45]=ec.title,X[46]=B):B=X[46],X[47]===Symbol.for("react.memo_cache_sentinel")?(M=(0,t.jsx)("div",{className:"mb-4 space-y-2 max-h-40 overflow-y-auto",children:(0,t.jsxs)("div",{className:"bg-black/50 backdrop-blur-sm rounded-lg px-3 py-2 text-white text-sm",children:[(0,t.jsx)("span",{className:"font-semibold",children:"User1:"})," Great stream!"]})}),X[47]=M):M=X[47],X[48]===Symbol.for("react.memo_cache_sentinel")?(A=e=>et(e.target.value),X[48]=A):A=X[48],X[49]!==ej?(T=e=>"Enter"===e.key&&ej(),X[49]=ej,X[50]=T):T=X[50],X[51]!==ee||X[52]!==T?(D=(0,t.jsx)(c.Input,{value:ee,onChange:A,onKeyDown:T,placeholder:"Add a comment...",className:"bg-transparent border-none text-white placeholder:text-white/60 focus-visible:ring-0"}),X[51]=ee,X[52]=T,X[53]=D):D=X[53],X[54]===Symbol.for("react.memo_cache_sentinel")?(F=(0,t.jsx)(u.Send,{className:"w-5 h-5"}),X[54]=F):F=X[54],X[55]!==ej?(H=(0,t.jsx)(n.Button,{onClick:ej,size:"icon",variant:"ghost",className:"text-white hover:bg-white/20 rounded-full",children:F}),X[55]=ej,X[56]=H):H=X[56],X[57]!==D||X[58]!==H?(U=(0,t.jsxs)("div",{className:"flex-1 flex items-center gap-2 bg-white/20 backdrop-blur-sm rounded-full px-4 py-2",children:[D,H]}),X[57]=D,X[58]=H,X[59]=U):U=X[59];let ev=ei?"bg-red-600 hover:bg-red-700":"bg-white/20 hover:bg-white/30";X[60]!==ev?($=(0,p.cn)("rounded-full w-12 h-12",ev),X[60]=ev,X[61]=$):$=X[61];let ew=ei?"fill-white":"";return X[62]!==ew?(G=(0,p.cn)("w-6 h-6",ew),X[62]=ew,X[63]=G):G=X[63],X[64]!==G?(O=(0,t.jsx)(d.Heart,{className:G}),X[64]=G,X[65]=O):O=X[65],X[66]!==eb||X[67]!==$||X[68]!==O?(P=(0,t.jsx)(n.Button,{onClick:eb,size:"icon",className:$,children:O}),X[66]=eb,X[67]=$,X[68]=O,X[69]=P):P=X[69],X[70]===Symbol.for("react.memo_cache_sentinel")?(Y=()=>ea(!0),X[70]=Y):Y=X[70],X[71]===Symbol.for("react.memo_cache_sentinel")?(E=(0,t.jsx)(n.Button,{onClick:Y,size:"icon",className:"rounded-full w-12 h-12 bg-gradient-to-br from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:(0,t.jsx)(m.Gift,{className:"w-6 h-6"})}),X[71]=E):E=X[71],X[72]!==U||X[73]!==P?(K=(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[U,P,E]}),X[72]=U,X[73]=P,X[74]=K):K=X[74],X[75]!==B||X[76]!==K?(R=(0,t.jsxs)("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/70 to-transparent z-10",children:[B,M,K]}),X[75]=B,X[76]=K,X[77]=R):R=X[77],X[78]!==L||X[79]!==z||X[80]!==R||X[81]!==w||X[82]!==y||X[83]!==N?(Q=(0,t.jsxs)("div",{className:"w-full h-screen relative",children:[w,y,N,L,z,R]}),X[78]=L,X[79]=z,X[80]=R,X[81]=w,X[82]=y,X[83]=N,X[84]=Q):Q=X[84],X[85]!==ec.host||X[86]!==ec.hostId||X[87]!==q||X[88]!==es||X[89]!==W?(J=es&&ec.host&&(0,t.jsx)(k,{open:es,onClose:()=>ea(!1),senderId:W,recipientId:ec.hostId,livestreamId:q}),X[85]=ec.host,X[86]=ec.hostId,X[87]=q,X[88]=es,X[89]=W,X[90]=J):J=X[90],X[91]!==Q||X[92]!==J?(V=(0,t.jsxs)("div",{className:"min-h-screen bg-black relative",children:[Q,J]}),X[91]=Q,X[92]=J,X[93]=V):V=X[93],V}e.s(["LivePlayer",()=>S],81946)},86838,e=>{e.n(e.i(81946))}]);